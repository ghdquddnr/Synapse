# PRD: Synapse 모바일 MVP

## 1. Introduction/Overview

### Problem Statement
사람들은 매일 수많은 생각과 아이디어를 떠올리지만, 기록하지 않으면 금방 잊혀집니다. 기존 노트 앱들은 제목 입력, 카테고리 분류 등의 번거로운 과정 때문에 빠른 캡처에 적합하지 않습니다. 또한 오프라인에서 검색이 느리거나 작동하지 않아, 기록한 내용을 찾기 어렵습니다.

### Solution
**Synapse(시냅스)**는 뇌의 신경세포를 연결하는 시냅스처럼, 생각을 1초 내에 즉시 기록하고, 오프라인에서도 빠르게 검색하며, AI가 자동으로 의미적 연결을 발견하는 지능형 노트 앱입니다.

### Goal
**M1(첫 출시) 목표**: 풀스택 개발자가 오프라인 우선의 노트 앱을 구축하여, 사용자가 어디서든 생각을 즉시 캡처하고 검색할 수 있으며, 온라인 시 AI가 관련 노트를 추천하고 주간 회고 리포트를 제공하는 완전한 MVP 시스템을 만든다.

---

## 2. Goals

### Primary Goals (M1 - 첫 출시)
1. **빠른 캡처**: 사용자가 아이디어를 1초 이내에 저장할 수 있다
2. **오프라인 검색**: 네트워크 없이도 전체 본문 검색이 150ms 이내에 완료된다
3. **지능적 연결**: AI가 의미적으로 관련된 노트를 자동 추천한다
4. **동기화 안정성**: 오프라인→온라인 전환 시 99% 이상의 동기화 성공률을 보장한다
5. **일일 회고**: 사용자가 하루를 한 줄로 회고하고, 주간 패턴을 발견한다

### Secondary Goals (M2-M3 - 확장)
6. **이미지 지원**: 노트에 이미지 첨부 가능
7. **성능 최적화**: 10,000개 노트에서도 빠른 검색 유지
8. **iOS 지원**: 크로스 플랫폼 확장
9. **데이터 보안**: 로컬 데이터베이스 암호화

---

## 3. User Stories

### US-1: 빠른 노트 작성
**As a** 사용자
**I want to** 제목 입력 없이 바로 생각을 기록하고 싶다
**So that** 아이디어를 놓치지 않고 즉시 캡처할 수 있다

**Acceptance Criteria:**
- 앱 실행 시 입력창이 자동 포커스된다
- 본문만 입력하면 저장 가능하다 (제목 불필요)
- 저장 완료까지 평균 0.8초 이내

---

### US-2: 오프라인 검색
**As a** 사용자
**I want to** 인터넷 없이도 과거 노트를 검색하고 싶다
**So that** 언제 어디서든 필요한 정보를 즉시 찾을 수 있다

**Acceptance Criteria:**
- 네트워크 연결 없이 검색 가능
- 검색 결과가 150ms 이내에 표시된다 (P95)
- 검색어가 본문에서 하이라이팅된다

---

### US-3: AI 관련 노트 추천
**As a** 사용자
**I want to** 현재 노트와 관련된 다른 노트를 자동으로 보고 싶다
**So that** 흩어진 생각들을 연결하여 새로운 통찰을 얻을 수 있다

**Acceptance Criteria:**
- 노트 상세 화면에 "관련 노트" 섹션 표시
- 온라인 시: AI 기반 추천 (임베딩 유사도)
- 오프라인 시: 로컬 키워드 기반 대체 추천
- 추천 이유가 명시된다 (공통 키워드, 유사 표현 등)

---

### US-4: 수동 노트 연결
**As a** 사용자
**I want to** 두 노트 사이에 직접 연결을 만들고 이유를 적고 싶다
**So that** 내 생각의 흐름을 명확히 기록할 수 있다

**Acceptance Criteria:**
- 노트 상세에서 "연결 추가" 버튼 제공
- 연결할 노트 검색 및 선택 가능
- 연결 이유를 짧은 텍스트로 입력 가능
- 양방향 연결 확인 가능 (A→B, B→A)

---

### US-5: 동기화
**As a** 사용자
**I want to** 오프라인에서 작성한 노트가 온라인 전환 시 자동으로 서버에 동기화되기를 바란다
**So that** 여러 기기에서 동일한 데이터를 볼 수 있다

**Acceptance Criteria:**
- 앱 재개 시 자동 동기화 트리거
- 오프라인 작업 내역이 큐에 저장된다
- 온라인 전환 시 자동으로 서버에 전송된다
- 동기화 성공/실패 피드백 제공
- 충돌 발생 시 LWW(Last-Write-Wins)로 자동 해결

---

### US-6: 일일 회고
**As a** 사용자
**I want to** 매일 하루를 한 줄로 회고하고 싶다
**So that** 내 생각의 패턴을 발견하고 성장할 수 있다

**Acceptance Criteria:**
- 회고 탭에서 오늘 날짜의 회고 입력 가능
- 하루에 1개의 회고만 작성 가능 (수정 가능)
- 주간 핵심 키워드 자동 표시 (상위 3개)

---

### US-7: 주간 리포트
**As a** 사용자
**I want to** 일주일 동안 작성한 노트를 자동으로 요약한 리포트를 보고 싶다
**So that** 내가 어떤 주제에 집중했는지 한눈에 파악할 수 있다

**Acceptance Criteria:**
- 주간 리포트 카드 표시 (요약, 클러스터, 키워드)
- 신규 키워드 vs 반복 키워드 구분
- 잠재적 연결 제안 (연결하면 좋을 노트 쌍)
- 리포트는 서버에서 생성되고 로컬에 캐시된다

---

### US-8: 이미지 첨부 (M2)
**As a** 사용자
**I want to** 노트에 이미지를 첨부하고 싶다
**So that** 텍스트로 설명하기 어려운 내용을 시각적으로 기록할 수 있다

**Acceptance Criteria:**
- 노트당 1장의 이미지 첨부 가능
- 이미지는 로컬에 저장되고 서버에도 업로드된다
- 최대 2MB 크기 제한 (자동 리사이징)
- 이미지 미리보기 제공

---

### US-9: 데이터 백업 (M2)
**As a** 사용자
**I want to** 내 모든 노트를 JSON 파일로 내보내고 싶다
**So that** 데이터를 백업하고 다른 도구로 이전할 수 있다

**Acceptance Criteria:**
- 설정 화면에서 "JSON 내보내기" 버튼 제공
- 모든 노트, 키워드, 연결, 회고가 포함된 JSON 파일 생성
- 파일 공유 기능 (이메일, 드라이브 등)
- 백업 파일에서 복원 기능 제공

---

## 4. Functional Requirements

### 4.1 노트 관리

#### FR-1.1: 노트 생성
시스템은 사용자가 본문(body)만 입력하여 노트를 생성할 수 있어야 한다.
- 제목 필드는 존재하지 않는다
- 본문은 필수 항목이며 최소 1자 이상이어야 한다
- 중요도는 1(낮음), 2(보통), 3(높음) 중 선택 가능 (기본값: 2)
- 선택사항: URL 첨부, 이미지 첨부 (M2)

#### FR-1.2: 노트 조회
시스템은 사용자가 노트 목록 및 상세를 조회할 수 있어야 한다.
- 목록 표시: 첫 줄을 제목처럼 표시 (최대 50자)
- 미리보기: 본문 전체를 축약 없이 표시
- 메타데이터: 생성일, 수정일, 중요도, 연결 개수 표시
- 삭제된 노트는 목록에서 제외된다 (soft delete)

#### FR-1.3: 노트 수정
시스템은 사용자가 기존 노트의 본문, 중요도, URL, 이미지를 수정할 수 있어야 한다.
- 수정 시 `updated_at` 타임스탬프가 자동 갱신된다
- 수정 내역은 `change_log` 테이블에 기록된다
- 오프라인 수정은 로컬에 저장되고 나중에 동기화된다

#### FR-1.4: 노트 삭제
시스템은 사용자가 노트를 삭제할 수 있어야 한다.
- Soft delete 방식 사용 (`deleted_at` 타임스탬프 설정)
- 삭제된 노트는 일반 목록에서 숨겨진다
- 삭제 작업은 동기화되어 다른 기기에도 반영된다

---

### 4.2 검색

#### FR-2.1: 전체 본문 검색
시스템은 사용자가 키워드로 노트 본문을 검색할 수 있어야 한다.
- SQLite FTS5를 사용한 전체 본문 검색
- 검색은 100% 오프라인에서 동작해야 한다
- 검색 결과는 관련도 순으로 정렬된다
- P95 응답 시간: 150ms 이하

#### FR-2.2: 검색어 하이라이팅
시스템은 검색 결과에서 검색어를 시각적으로 강조해야 한다.
- 일치하는 텍스트를 다른 색상으로 표시
- 대소문자 구분 없이 하이라이팅

#### FR-2.3: 최근 검색어 히스토리
시스템은 최근 검색어 20개를 저장하고 표시해야 한다.
- 검색 탭에서 최근 검색어 목록 표시
- 최근 검색어 클릭 시 재검색 실행
- 검색어 삭제 기능 제공

---

### 4.3 연결 관리

#### FR-3.1: 수동 연결 생성
시스템은 사용자가 두 노트 사이에 수동으로 연결을 만들 수 있어야 한다.
- 노트 상세 화면에서 "연결 추가" 버튼 제공
- 연결할 노트를 검색/선택할 수 있는 모달 표시
- 연결 타입 선택: `related`(관련됨), `contradicts`(모순), `elaborates`(확장)
- 연결 이유를 짧은 텍스트로 입력 가능 (선택사항)

#### FR-3.2: 연결 조회
시스템은 노트 상세 화면에서 모든 연결을 표시해야 한다.
- "수동 연결" 섹션: 사용자가 만든 연결 목록
- "관련 노트 추천 (AI)" 섹션: AI가 제안한 관련 노트 (온라인 시)
- 각 연결에 대한 이유/설명 표시

#### FR-3.3: 연결 삭제
시스템은 사용자가 기존 연결을 삭제할 수 있어야 한다.
- 연결 항목에서 스와이프 또는 삭제 버튼 제공
- 삭제는 즉시 로컬 DB에 반영되고 동기화된다

#### FR-3.4: AI 관련 노트 추천
시스템은 온라인 시 AI 기반으로 관련 노트를 추천해야 한다.
- 임베딩 벡터 코사인 유사도 기반 추천
- 키워드 자카드 계수 및 시간 가중치 적용
- 추천 스코어 0.3 이상인 노트만 표시
- 최대 10개까지 추천
- 오프라인 시: 로컬 키워드 기반 대체 추천 제공

---

### 4.4 회고

#### FR-4.1: 일일 회고 입력
시스템은 사용자가 매일 한 줄 회고를 입력할 수 있어야 한다.
- 회고 탭에서 오늘 날짜의 회고 입력창 제공
- 하루에 1개의 회고만 존재 (날짜별 unique)
- 기존 회고 수정 가능
- 회고는 로컬 저장 후 동기화된다

#### FR-4.2: 주간 핵심 키워드 표시
시스템은 이번 주에 가장 많이 사용된 키워드 상위 3개를 표시해야 한다.
- 주간 범위: 월요일 ~ 일요일
- 키워드 빈도 기반 정렬
- 키워드 클릭 시 해당 키워드가 포함된 노트 검색

#### FR-4.3: 주간 리포트 생성 및 조회
시스템은 주간 단위로 노트를 분석하여 리포트를 생성해야 한다.
- 서버에서 주간 리포트 생성 (백그라운드 작업)
- 클러스터링을 통한 주제 그룹핑 (3~5개 클러스터)
- 각 클러스터의 대표 문장 및 키워드 표시
- 신규 키워드 vs 반복 키워드 구분
- 잠재적 연결 제안 (연결하면 좋을 노트 쌍)
- 리포트는 로컬에 캐시되고 주간 단위로 갱신된다

---

### 4.5 동기화

#### FR-5.1: 변경 로그 기록
시스템은 모든 로컬 변경사항을 `change_log` 테이블에 기록해야 한다.
- 엔터티 타입: `note`, `relation`, `keyword`, `reflection`
- 작업 타입: `insert`, `update`, `delete`
- 클라이언트 타임스탬프 및 페이로드 포함
- 동기화 전까지 `synced_at`은 NULL

#### FR-5.2: Push 동기화
시스템은 로컬 변경사항을 서버에 배치 업로드해야 한다.
- 트리거: 앱 포그라운드 진입, 네트워크 복구, 수동 버튼
- 배치 크기: 최대 100개 또는 1MB
- 성공한 로그는 `synced_at` 업데이트
- 실패한 로그는 `retry_count` 증가 및 지수 백오프 재시도

#### FR-5.3: Pull 동기화
시스템은 서버로부터 다른 기기의 변경사항을 다운로드해야 한다.
- 클라이언트 체크포인트 이후의 델타만 수신
- 수신한 델타를 로컬 DB에 반영
- LWW(Last-Write-Wins) 충돌 해결
- 새로운 체크포인트 저장

#### FR-5.4: 충돌 해결
시스템은 동일 엔터티의 동시 수정 시 충돌을 자동으로 해결해야 한다.
- 1차: `updated_at` 타임스탬프 비교 (최신 우선)
- 2차: `server_timestamp` 비교
- 3차: `entity_id` 사전순 (결정적 비교)
- 충돌 발생 시 `conflict_log` 테이블에 기록

#### FR-5.5: 재시도 메커니즘
시스템은 네트워크 오류 시 지수 백오프 재시도를 수행해야 한다.
- 최대 5회 재시도
- 재시도 간격: 1초 → 2초 → 4초 → 8초 → 16초 (최대 60초)
- 지터 추가 (±20%)
- 재시도 불가 오류: 401, 403, 400, 422

#### FR-5.6: 동기화 상태 표시
시스템은 동기화 상태를 사용자에게 명확히 표시해야 한다.
- 동기화 중: 프로그레스 바 표시
- 성공: "동기화 완료 (N개 항목)" 토스트 메시지
- 실패: "동기화 실패: [이유]" 에러 메시지 및 재시도 버튼
- 미동기화 노트: 카드 우측 상단에 빨간 점 표시

---

### 4.6 키워드 관리

#### FR-6.1: 서버 키워드 추출
시스템은 서버에서 형태소 분석을 통해 키워드를 자동 추출해야 한다.
- Kiwipiepy를 사용한 한국어 형태소 분석
- 명사, 동사, 형용사 추출 (NNG, NNP, VV, VA)
- TF-IDF 스코어링으로 상위 5개 키워드 선정
- 1글자 단어 및 스톱워드 제외
- 추출된 키워드는 `note_keywords` 테이블에 저장 (source='server')

#### FR-6.2: 사용자 키워드 추가
시스템은 사용자가 수동으로 키워드를 추가할 수 있어야 한다.
- 노트 상세 화면에서 키워드 입력 필드 제공
- 입력한 키워드는 `note_keywords` 테이블에 저장 (source='user')
- 중복 키워드는 자동으로 병합된다

---

### 4.7 이미지 관리 (M2)

#### FR-7.1: 이미지 첨부
시스템은 사용자가 노트에 이미지를 첨부할 수 있어야 한다.
- 갤러리 또는 카메라에서 이미지 선택
- 최대 크기: 2MB (초과 시 자동 리사이징)
- 로컬 저장 경로: `{app_files}/images/{uuid}.jpg`
- 노트당 1장만 첨부 가능

#### FR-7.2: 이미지 업로드
시스템은 첨부된 이미지를 서버에 업로드해야 한다.
- 별도 엔드포인트: `POST /upload/image`
- S3 호환 스토리지에 저장 (Cloudflare R2 권장)
- 업로드 성공 시 URL을 `notes.image_url`에 저장
- 업로드 실패 시 로컬 경로 유지 및 재시도

#### FR-7.3: 이미지 표시
시스템은 노트에 첨부된 이미지를 표시해야 한다.
- 노트 상세 화면에서 이미지 미리보기
- 이미지 클릭 시 전체 화면 보기
- 로컬 이미지 우선 로딩, 없으면 서버 URL에서 다운로드

---

### 4.8 백업 및 복원 (M2)

#### FR-8.1: JSON 내보내기
시스템은 모든 데이터를 JSON 파일로 내보낼 수 있어야 한다.
- 설정 화면에서 "JSON 내보내기" 버튼 제공
- 포함 데이터: notes, keywords, note_keywords, relations, reflections
- 파일명 형식: `backup_YYYY-MM-DD_HHmmss.json`
- 파일 공유 시트 열기 (이메일, 드라이브 등)

#### FR-8.2: JSON 가져오기 (복원)
시스템은 백업된 JSON 파일을 가져올 수 있어야 한다.
- 설정 화면에서 "JSON 가져오기" 버튼 제공
- 파일 선택 후 데이터 유효성 검증 (버전, 스키마)
- 기존 데이터와 병합 또는 전체 교체 옵션 제공
- 트랜잭션으로 원자적 처리 (전체 성공 또는 전체 실패)

---

### 4.9 UI/UX 요구사항

#### FR-9.1: 하단 탭 바
시스템은 4개의 주요 화면을 하단 탭으로 제공해야 한다.
- 홈 탭: 노트 작성 및 목록
- 검색 탭: 검색 및 최근 검색어
- 회고 탭: 일일 회고 및 주간 리포트
- 설정 탭: 동기화, 백업, 앱 정보

#### FR-9.2: 로딩 상태
시스템은 긴 작업(>2초) 진행 시 로딩 표시를 제공해야 한다.
- Skeleton UI (목록 로딩 시)
- 프로그레스 바 (동기화, 백업 등)
- 스피너 (API 호출 대기)

#### FR-9.3: 에러 처리
시스템은 에러 발생 시 사용자 친화적인 메시지를 표시해야 한다.
- 네트워크 오류: "인터넷 연결을 확인해주세요"
- 동기화 오류: "동기화 중 문제가 발생했습니다. 잠시 후 다시 시도해주세요"
- 저장 공간 부족: "저장 공간이 부족합니다"
- 재시도 버튼 제공

#### FR-9.4: 오프라인 표시
시스템은 오프라인 상태를 명확히 표시해야 한다.
- 상단 고정 배너: "[!] 오프라인 모드. 변경 사항은 나중에 동기화됩니다."
- 미동기화 노트: 카드 우측 상단에 빨간 점 표시

---

## 5. Non-Goals (Out of Scope)

### M1 (첫 출시)에서 제외
❌ **인터랙티브 그래프 캔버스**: 노드 간 시각적 연결 그래프는 M3 이후 고려
❌ **음성 입력/STT**: 음성 기반 노트 작성은 M4 이후 고려
❌ **문서 스캔/OCR**: 종이 문서 디지털화는 범위 외
❌ **자동 번역**: 다국어 번역 기능은 범위 외
❌ **다중 사용자/협업**: 단일 사용자 전용, 협업 기능은 명시적으로 제외
❌ **종단간 암호화 (E2EE)**: 서버에서 내용을 분석해야 하므로 E2EE 불가
❌ **로컬 데이터베이스 암호화**: M1에서는 평문 저장, M3에서 SQLCipher 적용 예정
❌ **iOS 지원**: M1은 Android만, M3에서 iOS 추가

### 영구 제외
❌ **실시간 협업**: 단일 사용자 개인 노트 앱으로 설계됨
❌ **퍼블릭 노트 공유**: 프라이버시 중심 설계로 공유 기능 없음

---

## 6. Design Considerations

### 6.1 UI/UX 가이드라인
- **미니멀 디자인**: 불필요한 요소 제거, 콘텐츠에 집중
- **터치 타겟**: 최소 44x44pt 크기 보장
- **다크 모드**: 시스템 설정 자동 감지 및 적용
- **애니메이션**: 화면 전환 시 부드러운 애니메이션 (200-300ms)
- **폰트**: 시스템 기본 폰트 사용 (접근성 고려)

### 6.2 화면 구성
```
홈 탭:
- 상단: 입력창 (다중 라인, 자동 확장)
- 중간: 옵션 (중요도, URL, 이미지) - 접기/펼치기 가능
- 하단: 오늘의 노트 목록

검색 탭:
- 상단: 검색창
- 중간: 최근 검색어 (검색 전)
- 하단: 검색 결과 목록 (검색 후)

회고 탭:
- 상단: 오늘의 한 줄 입력창
- 중간: 이번 주 핵심 키워드
- 하단: 주간 리포트 카드

설정 탭:
- 동기화 상태 및 버튼
- 백업 (JSON 내보내기/가져오기)
- 표시 설정 (다크 모드, 글꼴 크기)
- 앱 정보 (버전, 저장소 사용량)
```

### 6.3 컬러 팔레트 (예시)
- Primary: #007AFF (파랑)
- Success: #34C759 (초록)
- Warning: #FF9500 (주황)
- Error: #FF3B30 (빨강)
- Background (Light): #FFFFFF
- Background (Dark): #000000
- Text (Light): #000000
- Text (Dark): #FFFFFF

---

## 7. Technical Considerations

### 7.1 기술 스택 (확정)

#### 모바일 클라이언트
- **프레임워크**: React Native (Expo SDK 52+)
- **언어**: TypeScript 5.6+
- **상태 관리**: Zustand (클라이언트 상태), React Query (서버 상태)
- **로컬 DB**: SQLite + FTS5 (expo-sqlite 15.0+)
- **네트워크**: Axios
- **인증 저장**: react-native-keychain

#### 백엔드
- **프레임워크**: Python FastAPI 0.115+
- **언어**: Python 3.12+
- **데이터베이스**: PostgreSQL 16 + pgvector
- **임베딩 모델**: intfloat/multilingual-e5-large (1024차원)
- **형태소 분석**: Kiwipiepy 0.18+
- **작업 큐**: Celery + Redis
- **인증**: JWT (python-jose)

### 7.2 아키텍처 패턴
- **Offline-First**: 로컬 SQLite가 단일 진실 공급원 (Single Source of Truth)
- **서버 역할**: 분석, 추천, 백업, 동기화 조정
- **동기화 프로토콜**: 변경 로그 기반 배치 Push/Pull
- **충돌 해결**: LWW (Last-Write-Wins)

### 7.3 데이터 모델 요약
```
notes 테이블:
- id (UUIDv7 PK), body (TEXT NOT NULL), importance (1-3)
- source_url, image_path, created_at, updated_at, deleted_at

notes_fts 테이블 (FTS5):
- body 전체 본문 검색 인덱스

keywords 테이블:
- id (UUIDv7 PK), name (UNIQUE)

note_keywords 테이블:
- note_id, keyword_id, weight, source ('server' or 'user')

relations 테이블:
- id (UUIDv7 PK), from_note_id, to_note_id, relation_type, rationale, source ('user' or 'ai')

reflections 테이블:
- id (UUIDv7 PK), content, date (UNIQUE)

weekly_reports 테이블:
- id (UUIDv7 PK), week_key (YYYY-WW), summary, data (JSON)

change_log 테이블:
- id (AUTOINCREMENT PK), entity_type, entity_id, operation, payload, client_timestamp, synced_at
```

### 7.4 API 엔드포인트 요약
```
인증:
POST /auth/login
POST /auth/refresh

동기화:
POST /sync/push
POST /sync/pull

추천:
GET /recommend/{note_id}?k=10

리포트:
GET /reports/weekly?week=YYYY-WW

이미지 (M2):
POST /upload/image
```

### 7.5 성능 목표
- **앱 콜드 스타트**: < 2초
- **노트 저장**: < 1초 (P95)
- **로컬 검색**: < 150ms (P95)
- **API P95 응답**: < 500ms
- **동기화 성공률**: > 99%

### 7.6 보안 고려사항
- **전송 보안**: HTTPS (TLS 1.3) 필수
- **인증**: JWT 토큰 (Access: 1시간, Refresh: 30일)
- **토큰 저장**: react-native-keychain (Keychain/Keystore)
- **로컬 DB**: M1은 평문 저장, M3에서 SQLCipher 암호화 적용

---

## 8. Success Metrics

### 8.1 사용자 참여도 (Primary)

| 지표 | 목표 (M2 기준) | 측정 방법 |
|------|----------------|-----------|
| **DAU (일간 활성 사용자)** | 100명 | 앱 실행 이벤트 로깅 |
| **평균 노트 작성 수** | ≥ 3개/일 | 노트 생성 이벤트 집계 |
| **검색 사용률** | ≥ 60% | 검색 기능 사용자 / DAU |
| **주간 회고 입력률** | ≥ 40% | 회고 입력 / 전체 사용자 |
| **추천 클릭률** | ≥ 20% | 추천 노트 클릭 / 추천 노출 |
| **주간 리포트 조회율** | ≥ 50% | 리포트 조회 / 리포트 생성 |

### 8.2 기술 성능 (Secondary)

| 지표 | 목표 | 측정 방법 |
|------|------|-----------|
| **크래시율** | ≤ 0.3% | Sentry 리포트 |
| **동기화 성공률** | ≥ 99% | 성공 건수 / 전체 동기화 시도 |
| **API P95 응답 시간** | < 500ms | Prometheus 메트릭 |
| **검색 P95 응답 시간** | < 150ms | 클라이언트 성능 로그 |
| **스크롤 FPS** | ≥ 55 FPS | React Native Performance Monitor |

### 8.3 사용자 만족도 (Secondary)

| 지표 | 목표 | 측정 방법 |
|------|------|-----------|
| **사용자 유지율 (D7)** | ≥ 40% | 7일 후 재방문율 |
| **앱 평점** | ≥ 4.5 / 5.0 | Google Play Store 리뷰 |

---

## 9. Open Questions

### Q1: 임베딩 모델 성능 검증
**질문**: 짧은 메모 (1-2단어)의 임베딩 품질이 충분한가?
**현재 계획**: 문맥 보강 (관련 노트 스니펫 추가) 및 키워드 기반 대체 추천
**검증 필요**: M1 배포 후 실사용 데이터로 품질 측정

### Q2: 동기화 큐 최대 크기
**질문**: 10,000개 제한이 적절한가? 더 작아야 하는가?
**현재 계획**: 10,000개 초과 시 읽기 전용 모드 진입
**검증 필요**: 베타 테스트 중 오프라인 사용 패턴 분석

### Q3: 주간 리포트 생성 타이밍
**질문**: 주간 리포트를 언제 생성하는가? (일요일 자정? 월요일 아침?)
**현재 계획**: 일요일 자정 (UTC 기준) 백그라운드 작업
**검증 필요**: 사용자 피드백 수집 후 조정

### Q4: 이미지 첨부 개수
**질문**: M2에서 노트당 이미지 1장 제한이 충분한가?
**현재 계획**: 1장만 지원 (복잡도 최소화)
**검증 필요**: 사용자 요청 빈도 모니터링 후 M3에서 다중 이미지 검토

### Q5: iOS 우선순위
**질문**: M3에서 iOS 지원을 반드시 포함해야 하는가?
**현재 계획**: M3에서 iOS 추가
**검증 필요**: M1-M2 사용자 피드백 및 플랫폼 요구 분석

### Q6: 로컬 데이터베이스 암호화 시점
**질문**: M1에서 평문 저장의 리스크가 허용 가능한가?
**현재 계획**: M1은 평문, M3에서 SQLCipher 적용
**검증 필요**: 사용자 프라이버시 민감도 조사 및 법적 요구사항 확인

---

## 10. Appendix

### 10.1 용어 정리
- **노트**: 사용자가 작성한 생각/아이디어 기록 (제목 없이 본문만 존재)
- **본문(body)**: 노트의 실제 내용
- **중요도**: 1(낮음), 2(보통), 3(높음)
- **연결(relation)**: 노트 간 관계 (수동 또는 AI 생성)
- **키워드**: 노트에서 추출된 핵심 단어
- **임베딩**: 텍스트의 벡터 표현 (1024차원)
- **FTS5**: SQLite 전체 본문 검색 확장
- **LWW**: Last-Write-Wins, 최신 수정 우선 충돌 해결
- **체크포인트**: 동기화 진행 지점 (타임스탬프)
- **델타**: 증분 변경 사항

### 10.2 개발 마일스톤

#### M0 - 기본 기능 (2주)
- React Native 프로젝트 세팅
- SQLite + FTS5 설정
- 노트 CRUD
- 전체 본문 검색
- 수동 연결
- 기본 UI (홈, 검색, 상세)

#### M1 - 동기화 & AI (3주) ← **현재 PRD 범위**
- FastAPI 백엔드 구축
- PostgreSQL + pgvector 설정
- JWT 인증
- 동기화 프로토콜 (Push/Pull)
- 임베딩 생성 및 AI 추천
- 회고 탭 (일일 회고 + 주간 키워드)

#### M2 - 미디어 & 최적화 (3주)
- 이미지 첨부 및 업로드
- Redis 캐싱
- 주간 리포트 생성
- JSON 백업/복원
- 성능 프로파일링
- Sentry 크래시 리포팅

#### M3 - 확장 & iOS (4주)
- 간소형 그래프 보기
- SQLCipher 데이터베이스 암호화
- 생체 인증
- iOS 빌드 및 앱 스토어 제출
- Grafana 모니터링 대시보드

### 10.3 참고 문서
- [Synapse MVP 사양서 v3.1](./Synapse_Mobile_MVP_v3.1_Final.md)
- [React Native 문서](https://reactnative.dev/)
- [Expo 문서](https://docs.expo.dev/)
- [FastAPI 문서](https://fastapi.tiangolo.com/)
- [pgvector GitHub](https://github.com/pgvector/pgvector)
- [multilingual-e5-large 모델](https://huggingface.co/intfloat/multilingual-e5-large)

---

**PRD 버전**: 1.0
**생성일**: 2025-10-15
**작성자**: Claude AI (사용자 요청 기반)
**승인 대기**: 사용자 검토 필요
